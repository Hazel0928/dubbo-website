---
aliases:
    - /zh/docs3-v2/java-sdk/upgrades-and-compatibility/3.2-to-3.3-compatibility-guide/
    - /zh-cn/docs3-v2/java-sdk/upgrades-and-compatibility/3.2-to-3.3-compatibility-guide/
description: Dubbo 3.3 升级与兼容性指南
linkTitle: 3.2 升级至 3.3
title: 3.2 升级至 3.3
type: docs
weight: 4

---


对于绝大多数的用户，升级到 Dubbo 3.3.0 是完全平滑的，仅需要修改依赖包版本即可。

```xml
<dependency>
    <groupId>org.apache.dubbo</groupId>
    <artifactId>dubbo</artifactId>
    <version>3.3.0</version>
</dependency>
```

或者

```xml
<dependency>
    <groupId>org.apache.dubbo</groupId>
    <artifactId>dubbo-spring-boot-starter</artifactId>
    <version>3.3.0</version>
</dependency>
```

# 兼容性 CheckList

### 1. 默认序列化切换

Dubbo 3.3.0 版本开始默认序列化方式从 `fastjson2` 切换为 `hessian2`，对于升级到 3.3.0 的应用，Dubbo 会自动尝试采用 `hessian2` 进行序列化。

#### Q1：为什么要切换默认序列化方式？

`hessian2` 为 Dubbo 3.1.x 及以下版本中默认的序列化，长期的生产验证了其稳定性和兼容性，在评估了向前兼容性和长期可维护性后，Dubbo 团队决定将 `hessian-lite` 升级到最新 `hessian4` 主干版本，以支持 JDK17 和 JDK21。

升级到 Dubbo 3.3.0 以后，依赖的 `hessian-lite` 版本将同步升级为 `4.0.x`，主要包含以下修改：
- 同步 hessian 到上游 4.0.66 版本
- 修复 JDK17 及 JDK21 下类可见性带来的兼容性问题
- 支持 Record、ImmutableCollections 等 JDK9+ 特性

#### Q2：会不会影响和低版本的 Dubbo 互通？

部分场景下可能会有影响，具体如下：

1. Dubbo 3.3.x Consumer 与 Dubbo 3.2.x Provider 互通时默认使用 Dubbo 3.2.x 中 `fastjson2` 优先的策略，无兼容性问题
2. Dubbo 3.3.x Consumer 与 Dubbo 3.1.x 及以下版本 Provider 互通时默认使用 Dubbo 3.2.x 中 `fastjson2` 优先的策略，无兼容性问题
3. Dubbo 3.2.x Consumer 与 Dubbo 3.3.x Provider 互通时默认使用 Dubbo 3.3.x 中 `hessian2` 优先的策略，此时由于 Dubbo 3.2.x Consumer 中携带的 `hessian2` 为低版本的，在 JDK >= 17 的场景下可能会出现兼容性问题，建议按照 Q3 中的最佳实践进行升级。
4. Dubbo 3.1.x 及以下版本 Consumer 与 Dubbo 3.3.x Provider 互通时默认使用 Dubbo 3.3.x 中 `hessian2` 优先的策略，此时由于 Dubbo 3.1.x 及以下版本 Consumer 中携带的 `hessian2` 为低版本的，在 JDK >= 17 的场景下可能会出现兼容性问题，建议按照 Q3 中的最佳实践进行升级。

原理可参考[序列化协议升级指南](/zh-cn/overview/mannual/java-sdk/upgrades-and-compatibility/serialization-upgrade/)一文。

#### Q3：升级序列化最佳实践是什么？

1. 从 Dubbo 3.2.x 升级到 3.3.x 时，建议配置 `prefer-serialization` 为 `fastjson2,hessian2` 保持与 3.2.x 一致，待全集群升级完毕后在删除该配置，使用 `hessian2` 序列化
2. 从 Dubbo 3.1.x 及以下版本升级到 3.3.x 时，无需配置 `prefer-serialization`，但需要注意避免与 JDK 升级一起进行，以免出现兼容性问题

#### Q4：如果我仍想使用 `fastjson2`，怎么办？

如果你不想使用 `hessian2`，可以配置 `prefer-serialization` 为 `fastjson2` 覆盖默认配置。（如 `dubbo.provider.prefer-serialization=fastjson2,hessian2`）

---

### 2. Register=false


---

### 3. Nacos 订阅名字


---

### 4. Starters

---

### 5. 移除 dubbo-native-plugin

在 3.3 版本中，移除了 dubbo-native-plugin。并且dubbo-native-plugin相关的功能都将迁移至dubbo-maven-plugin。

#### Q1：为什么要做这个迁移和调整？

1. 为了提升用户的使用体验，后续dubbo有关maven的插件能力都将统一使用dubbo-maven-plugin来提供。方便Dubbo用户使用和接入。而不需要一个特性对应一个插件，导致用户需要依赖多个plugin。
2. 更加有利于后续Dubbo提供maven plugin能力时的维护和特性增强。

#### Q2：如何迁移配置？


---


### 6. 移除 Rest 协议

---

### 7. JDK 序列化

